{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Generate - PaloAlto Blocked C2 Connection Alert",
    "aliasName": null,
    "tag": null,
    "description": "Generates demo alert for the Alert Type 'Beconing' for 'Malicious C2 Outbound Traffic'",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "lastModifyDate": 1644846586,
    "collection": "\/api\/3\/workflow_collections\/7fc569b3-669e-4d7a-8587-ecfc2015add4",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/dbeffc83-30b3-4a63-bd10-b8da6279eab1",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "data": "{\n\t\"date_zone\": \"local\",\n\t\"Rule\": \"Outbound-Known C2 Port\",\n\t\"Application\": \"http\",\n\t\"splunk_server\": \"splunk.cyops.local\",\n\t\"timeendpos\": \"34\",\n\t\"date_second\": \"23\",\n\t\"dg_hier_level_1\": \"0\",\n\t\"Time _Logged\": \"2019\/05\/05 16:14:23\",\n\t\"Tunnel_ID_IMSI\": \"0\",\n\t\"Domain\": \"1\",\n\t\"_bkt\": \"paloalto~0~6409E7A2-226D-4295-A216-8E6F0A213CBB\",\n\t\"eventtype\": \"\",\n\t\"Bytes_Sent\": \"419\",\n\t\"_indextime\": \"1557087272\",\n\t\"Elapsed_Time _sec\": \"0\",\n\t\"Config_Version\": \"1\",\n\t\"Parent_Session_ID\": \"0\",\n\t\"_sourcetype\": \"csv\",\n\t\"_cd\": \"0:395\",\n\t\"Source_Port\": \"52572\",\n\t\"_raw\": \"1,2019\/05\/05 16:14:23,012001006716,TRAFFIC,start,1,2019\/05\/05 16:14:23,192.168.60.132,103.224.212.222,23.31.215.245,103.224.212.222,Outbound-Known C2 Port,,,ssl,vsys1,Internal_lan,Untrust,ethernet1\/3,ethernet1\/4,Splunk-157,2019\/05\/05 16:14:23,74497,1,63737,443,8816,443,0x400000,tcp,allow,493,419,74,4,2019\/05\/05 16:14:22,0,any,0,19337369,0x0,192.168.0.0-192.168.255.255,United States,0,3,1,n\/a,0,0,0,0,,PA-820,from-policy,,,0,,0,,N\/A\",\n\t\"splunk_server_group\": \"\",\n\t\"index\": \"paloalto\",\n\t\"dg_hier_level_2\": \"0\",\n\t\"ids_type\": \"\",\n\t\"Log_Action\": \"Splunk-157\",\n\t\"NAT_Destination_Port\": \"31337\",\n\t\"NAT_Source Port\": \"8816\",\n\t\"product\": \"\",\n\t\"_time\": \"1520284463.012001\",\n\t\"Action_Flags\": \"0x0\",\n\t\"date_year\": \"2019\",\n\t\"Outbound_Interface\": \"ethernet1\/4\",\n\t\"dg_hier_level_3\": \"0\",\n\t\"session_end_reason\": \"n\/a\",\n\t\"Virtual_System\": \"vsys1\",\n\t\"Flags\": \"0x400000\",\n\t\"pkts_sent\": \"3\",\n\t\"NAT_Destination_IP\": \"103.224.212.222\",\n\t\"action_source\": \"from-policy\",\n\t\"sourcetype\": \"csv\",\n\t\"punct\": \",\/\/_::,,,,,\/\/_::,...,...,...,...,,,,,,,,\/,\/,-,\/\/_:\",\n\t\"date_wday\": \"monday\",\n\t\"vendor\": \"\",\n\t\"tunnel\": \"N\/A\",\n\t\"NAT_Source_IP\": \"23.31.215.245\",\n\t\"dg_hier_level_4\": \"0\",\n\t\"tag::eventtype\": \"\",\n\t\"Destination_Port\": \"31337\",\n\t\"date_hour\": \"16\",\n\t\"Packets\": \"3\",\n\t\"Destination_Country\": \"United States\",\n\t\"Bytes_Received\": \"74\",\n\t\"Start_Time\": \"2019\/05\/05 16:14:22\",\n\t\"Threat_Content Type\": \"start\",\n\t\"Serial \": \"012001006716\",\n\t\"Source_address\": \"192.168.60.132\",\n\t\"cpadding\": \"0\",\n\t\"_si\": \"splunk.cyops.local\\npaloalto\",\n\t\"event_id\": \"6409E7A2-226D-4295-A216-8E6F0A213CBB@@paloalto@@ec50556565899fc185660ffada9bbc34\",\n\t\"timestartpos\": \"2\",\n\t\"Action\": \"allow\",\n\t\"Padding\": \"0\",\n\t\"tag\": \"\",\n\t\"Bytes\": \"493\",\n\t\"vendor_product\": \"\",\n\t\"date_mday\": \"5\",\n\t\"source\": \"log.csv\",\n\t\"Repeat_Count\": \"1\",\n\t\"host\": \"paloalto-FW1.cyops.local\",\n\t\"Source_Zone\": \"Internal_lan\",\n\t\"Generate_Time\": \"2019\/05\/05 16:14:23\",\n\t\"Inbound_Interface\": \"ethernet1\/3\",\n\t\"Session_ID\": \"74497\",\n\t\"Type\": \"TRAFFIC\",\n\t\"linecount\": \"1\",\n\t\"Device_Name\": \"PA-820\",\n\t\"Sequence_Number\": \"19337369\",\n\t\"date_minute\": \"14\",\n\t\"_eventtype_color\": \"\",\n\t\"Destination_address\": \"103.224.212.222\",\n\t\"Category\": \"C2\",\n\t\"date_month\": \"may\",\n\t\"_subsecond\": \".012001\",\n\t\"IP_Protocol\": \"tcp\",\n\t\"_serial\": \"1\",\n\t\"Receive_Time\": \"2019\/05\/05 16:14:23\",\n\t\"pkts_received\": \"0\",\n\t\"Destination Zone\": \"Untrust\"\n}",
                "assignee": "{{(vars.steps.Get_available_assignees.data['hydra:member'] | json_query('[*].[\"@id\"][]') | shuffle)[0]}}"
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "45ac015c-52e3-4bfa-aa42-5dc676b89e94"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Task",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "Pull network data and investigate",
                    "type": {
                        "id": 70,
                        "@id": "\/api\/3\/picklists\/30300411-a2e0-42dc-9180-513904f73ab9",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "To Do",
                        "listName": "\/api\/3\/picklist_names\/b837e375-76af-4ba5-b6a1-bd1c3cd27292",
                        "itemValue": "To Do",
                        "orderIndex": 8
                    },
                    "alerts": "['{{vars.steps.Create_Alert_Record['@id']}}']",
                    "status": {
                        "id": 117,
                        "@id": "\/api\/3\/picklists\/959021fc-c19d-4aee-8e51-5395c5029719",
                        "icon": null,
                        "uuid": "959021fc-c19d-4aee-8e51-5395c5029719",
                        "@type": "Picklist",
                        "color": "#ffce1f",
                        "display": "In progress",
                        "listName": "\/api\/3\/picklist_names\/21ddbcfd-b4a3-4273-adea-c674fe47d643",
                        "itemValue": "In progress",
                        "orderIndex": 0
                    },
                    "priority": {
                        "id": 158,
                        "@id": "\/api\/3\/picklists\/90088ebe-0a7d-4aa6-9c9c-93b937a4e4f8",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#e36c29",
                        "display": "High",
                        "listName": "\/api\/3\/picklist_names\/bea9a490-50d1-4597-8ad9-24422e10676e",
                        "itemValue": "High",
                        "orderIndex": 2
                    },
                    "__replace": "",
                    "description": "<p>Download relevant packet capture and netflow data, determine if traffic from this alert really is C2 activity or a false positive.<\/p>",
                    "assignedToPerson": "{{vars.assignee}}"
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/tasks",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "3350a521-0bba-4da5-ac9b-db44b655ed33"
        },
        {
            "@type": "WorkflowStep",
            "name": "RecordIRI",
            "description": null,
            "arguments": {
                "recordIRI": "{{vars.steps.Create_Alert_Record}}"
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "uuid": "47b32011-a2c3-4622-8b93-9957351b324b"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Alert Record",
            "description": null,
            "arguments": {
                "resource": {
                    "name": "Outbound Connection Attempt Using Known C2 Port",
                    "type": {
                        "id": 4484,
                        "@id": "\/api\/3\/picklists\/844c0b64-04fa-494f-9795-7c8406e59f69",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Beaconing",
                        "listName": "\/api\/3\/picklist_names\/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                        "itemValue": "Beaconing",
                        "orderIndex": 0
                    },
                    "source": "PaloAlto Firewall",
                    "status": {
                        "id": 22,
                        "@id": "\/api\/3\/picklists\/7de816ff-7140-4ee5-bd05-93ce22002146",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Open",
                        "listName": "\/api\/3\/picklist_names\/33e964a9-d607-49f2-813c-7ce46141815a",
                        "itemValue": "Open",
                        "orderIndex": 1
                    },
                    "severity": {
                        "id": 60,
                        "@id": "\/api\/3\/picklists\/40187287-89fc-4e9c-b717-e9443d57eedb",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#DE7A13",
                        "display": "High",
                        "listName": "\/api\/3\/picklist_names\/4e80cba3-032f-48b4-ac03-17e3ec247aac",
                        "itemValue": "High",
                        "orderIndex": 3
                    },
                    "sourceIp": "{{vars.data.Source_address}}",
                    "__replace": "true",
                    "epochTime": "{{vars.data._indextime}}",
                    "eventTime": "{{vars.data.Start_Time}}",
                    "assignedTo": "{{vars.assignee}}",
                    "sourcePort": "{{vars.data.Source_Port}}",
                    "sourceTool": "PaloAlto Firewall",
                    "sourcedata": "{{vars.data | toJSON}}",
                    "description": "<p>PaloAlto firewall {{vars.data.host}} has blocked an outbound connection using a common C2 port.<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>\n<p>&nbsp;<\/p>",
                    "ackSlaStatus": {
                        "id": 289,
                        "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#808080",
                        "display": "Awaiting Action",
                        "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                        "itemValue": "Awaiting Action",
                        "orderIndex": 2
                    },
                    "closureReason": {
                        "id": 251,
                        "@id": "\/api\/3\/picklists\/8590c81e-3307-4645-97f5-c3e1bec4e05a",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Tasks Completed",
                        "listName": "\/api\/3\/picklist_names\/4ebacea1-88cd-4ea8-9dcc-385bea42cc59",
                        "itemValue": "Tasks Completed",
                        "orderIndex": 0
                    },
                    "destinationIp": "{{vars.data.Destination_address}}",
                    "respSlaStatus": {
                        "id": 289,
                        "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#808080",
                        "display": "Awaiting Action",
                        "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                        "itemValue": "Awaiting Action",
                        "orderIndex": 2
                    },
                    "killChainPhase": {
                        "id": 372,
                        "@id": "\/api\/3\/picklists\/8153c438-9fe4-4eef-b3af-752e26f665ab",
                        "icon": null,
                        "@type": "Picklist",
                        "color": null,
                        "display": "Command & Control",
                        "listName": "\/api\/3\/picklist_names\/eddbc863-c725-479a-867f-cec66206a6b4",
                        "itemValue": "Command & Control",
                        "orderIndex": 6
                    },
                    "destinationPort": "{{vars.data.Destination_Port}}",
                    "escalatedtoincident": {
                        "id": 6808,
                        "@id": "\/api\/3\/picklists\/2128a09c-153d-4db3-985d-de6be33deae5",
                        "icon": null,
                        "@type": "Picklist",
                        "color": "#808080",
                        "display": "No",
                        "listName": "\/api\/3\/picklist_names\/e131cc54-9ae4-43c9-b830-af6e331fe024",
                        "itemValue": "No",
                        "orderIndex": 1
                    }
                },
                "_showJson": false,
                "operation": "Overwrite",
                "collection": "\/api\/3\/upsert\/alerts",
                "tagsOperation": "OverwriteTags",
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "uuid": "5004f214-7d94-42a5-a8f3-87eb84e922ab"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": []
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "uuid": "dbeffc83-30b3-4a63-bd10-b8da6279eab1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get available assignees",
            "description": null,
            "arguments": {
                "params": {
                    "iri": "\/api\/3\/people",
                    "body": "",
                    "method": "GET"
                },
                "version": "2.6.0",
                "connector": "cyops_utilities",
                "operation": "make_cyops_request",
                "operationTitle": "CyOPs: Make CyOPs API Call",
                "step_variables": []
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "uuid": "67b98969-d8d2-40d1-b460-5c49e6e64011"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Get available assignees -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/45ac015c-52e3-4bfa-aa42-5dc676b89e94",
            "sourceStep": "\/api\/3\/workflow_steps\/67b98969-d8d2-40d1-b460-5c49e6e64011",
            "label": null,
            "isExecuted": false,
            "uuid": "97b25866-a16a-4549-94cb-62825f3aecf7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Alert Record -> Create Task",
            "targetStep": "\/api\/3\/workflow_steps\/3350a521-0bba-4da5-ac9b-db44b655ed33",
            "sourceStep": "\/api\/3\/workflow_steps\/5004f214-7d94-42a5-a8f3-87eb84e922ab",
            "label": null,
            "isExecuted": false,
            "uuid": "7d446652-397e-44d0-a978-ef720b1aff68"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Get available assignees",
            "targetStep": "\/api\/3\/workflow_steps\/67b98969-d8d2-40d1-b460-5c49e6e64011",
            "sourceStep": "\/api\/3\/workflow_steps\/dbeffc83-30b3-4a63-bd10-b8da6279eab1",
            "label": null,
            "isExecuted": false,
            "uuid": "ebc81cd4-8a3d-4b88-bc38-b926c84a2751"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Create Alert Record",
            "targetStep": "\/api\/3\/workflow_steps\/5004f214-7d94-42a5-a8f3-87eb84e922ab",
            "sourceStep": "\/api\/3\/workflow_steps\/45ac015c-52e3-4bfa-aa42-5dc676b89e94",
            "label": null,
            "isExecuted": false,
            "uuid": "66977395-a337-4d6b-9c8a-f8b1b1cd2ad9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Task -> RecordIRI",
            "targetStep": "\/api\/3\/workflow_steps\/47b32011-a2c3-4622-8b93-9957351b324b",
            "sourceStep": "\/api\/3\/workflow_steps\/3350a521-0bba-4da5-ac9b-db44b655ed33",
            "label": null,
            "isExecuted": false,
            "uuid": "d967e3b2-5943-4f47-9d87-14147546fcf9"
        }
    ],
    "priority": null,
    "uuid": "8089902b-a235-4868-b5e0-b0d7869c3c93",
    "recordTags": [
        "FSRSolutionPack",
        "Referenced",
        "c2MalwareTrafficResponse-1.0.0"
    ],
    "id": "544",
    "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "createDate": 1644846587.188472,
    "modifyUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
    "modifyDate": 1644846587.188472,
    "owners": [],
    "isPrivate": false,
    "deletedAt": null
}